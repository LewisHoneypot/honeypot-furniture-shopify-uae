{% doc %}
  @prompt
    A heading with the last word highlighted with an animation

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-animated-heading-{{ ai_gen_id }} {
    text-align: {{ block.settings.text_alignment }};
    margin-top: {{ block.settings.margin_top }}px;
    margin-bottom: {{ block.settings.margin_bottom }}px;
  }

  .ai-animated-heading-{{ ai_gen_id }} h2 {
    display: inline-block;
    font-size: {{ block.settings.heading_size }}px;
    font-weight: {{ block.settings.font_weight }};
    color: {{ block.settings.heading_color }};
    line-height: 1.2;
    margin: 0;}

  .ai-animated-heading-{{ ai_gen_id }} .ai-animated-word-{{ ai_gen_id }} {
    display: inline-block;
    color: {{ block.settings.highlight_color }};
    position: relative;
    margin-left: 8px;
  }

  {% if block.settings.animation_type == 'underline' %}
    .ai-animated-heading-{{ ai_gen_id }} .ai-animated-word-{{ ai_gen_id }}::after {
      content: '';
      position: absolute;
      width: 100%;
      height: {{ block.settings.animation_thickness }}px;
      bottom: 0;
      left: 0;
      background-color: {{ block.settings.animation_color }};
      transform: scaleX(0);
      transform-origin: bottom right;
      transition: transform {{ block.settings.animation_duration }}ms ease-out;
    }

    .ai-animated-heading-{{ ai_gen_id }}:hover .ai-animated-word-{{ ai_gen_id }}::after {
      transform: scaleX(1);
      transform-origin: bottom left;
    }
  {% elsif block.settings.animation_type == 'background' %}
    .ai-animated-heading-{{ ai_gen_id }} .ai-animated-word-{{ ai_gen_id }} {
      position: relative;
      z-index: 1;
      padding: 0 5px;
    }

    .ai-animated-heading-{{ ai_gen_id }} .ai-animated-word-{{ ai_gen_id }}::before {
      content: '';
      position: absolute;
      z-index: -1;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      background-color: {{ block.settings.animation_color }};
      transform-origin: center right;
      transform: scaleX(0);
      transition: transform {{ block.settings.animation_duration }}ms ease-out;
    }

    .ai-animated-heading-{{ ai_gen_id }}:hover .ai-animated-word-{{ ai_gen_id }}::before {
      transform-origin: center left;
      transform: scaleX(1);
    }
  {% elsif block.settings.animation_type == 'highlight' %}
    .ai-animated-heading-{{ ai_gen_id }} .ai-animated-word-{{ ai_gen_id }} {
      position: relative;
      z-index: 1;
      padding: 0 5px;
    }

    .ai-animated-heading-{{ ai_gen_id }} .ai-animated-word-{{ ai_gen_id }}::before {
      content: '';
      position: absolute;
      z-index: -1;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      background-color: {{ block.settings.animation_color }};
      opacity: 0.3;
      transform-origin: center bottom;
      transform: scaleY(0.1);
      transition: transform {{ block.settings.animation_duration }}ms ease-out;
    }

    .ai-animated-heading-{{ ai_gen_id }}:hover .ai-animated-word-{{ ai_gen_id }}::before {
      transform-origin: center bottom;
      transform: scaleY(1);
    }
  {% endif %}

  @media screen and (max-width: 749px) {
    .ai-animated-heading-{{ ai_gen_id }} h2 {
      font-size: {{ block.settings.heading_size_mobile }}px;
    }
  }
{% endstyle %}

<div class="ai-animated-heading-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  {% if block.settings.heading != blank %}
    {% assign heading_words = block.settings.heading | split: ' ' %}
    {% assign last_word = heading_words | last %}
    {% assign heading_without_last = heading_words | slice: 0, heading_words.size | minus: 1 | join: ' ' %}
    <h2>
      {{ heading_without_last }}
      <span class="ai-animated-word-{{ ai_gen_id }}">{{ last_word }}</span>
    </h2>
  {% else %}
    <h2>
      Sample Animated
      <span class="ai-animated-word-{{ ai_gen_id }}">Heading</span>
    </h2>
  {% endif %}
</div>

{% schema %}
{
  "name": "Animated Heading",
  "tag": null,
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading text",
      "default": "Your Amazing Heading"
    },
    {
      "type": "header",
      "content": "Animation Settings"
    },
    {
      "type": "select",
      "id": "animation_type",
      "label": "Animation type",
      "options": [
        {
          "value": "underline",
          "label": "Underline"
        },
        {
          "value": "background",
          "label": "Background fill"
        },
        {
          "value": "highlight",
          "label": "Highlight"
        }
      ],
      "default": "underline"
    },
    {
      "type": "range",
      "id": "animation_duration",
      "min": 200,
      "max": 1000,
      "step": 50,
      "unit": "ms",
      "label": "Animation duration",
      "default": 400
    },
    {
      "type": "range",
      "id": "animation_thickness",
      "min": 1,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Animation thickness (for underline)",
      "default": 3
    },
    {
      "type": "header",
      "content": "Style Settings"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 20,
      "max": 80,
      "step": 2,
      "unit": "px",
      "label": "Heading size (desktop)",
      "default": 40
    },
    {
      "type": "range",
      "id": "heading_size_mobile",
      "min": 16,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Heading size (mobile)",
      "default": 32
    },
    {
      "type": "select",
      "id": "font_weight",
      "label": "Font weight",
      "options": [
        {
          "value": "400",
          "label": "Regular"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semibold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "700"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "highlight_color",
      "label": "Highlighted word color",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "animation_color",
      "label": "Animation color",
      "default": "#2A6876"
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Top margin",
      "default": 20
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Bottom margin",
      "default": 20
    }
  ],
  "presets": [
    {
      "name": "Animated Heading"
    }
  ]
}
{% endschema %}