{% comment %}
  Sofa Estimator Snippet — used inside sidebar drawer
{% endcomment %}

<section id="get-estimate" class="container">
  <h2>{{ block.settings.main_heading }}</h2>

  <!-- Step 1 -->
  <div class="section">
    <h3>{{ block.settings.step1_heading }}</h3>
    <div class="row options-1">
      {% for sub_block in block.blocks %}
        {% if sub_block.type == 'sofa_type' %}
          <div
            class="col{% if forloop.first %} active{% endif %}"
            data-value="{{ sub_block.settings.value }}"
            data-index="{{ forloop.index }}"
          >
            <div class="border rounded">
              <div class="title">{{ sub_block.settings.label }}</div>
              {% if sub_block.settings.image != blank %}
                <img
                  src="{{ sub_block.settings.image | image_url: width: sub_block.settings.image_width }}"
                  alt="{{ sub_block.settings.label }}"
                  style="max-width:{{ sub_block.settings.image_width }}px;"
                  height=""
                  width=""
                >
              {% else %}
                <img
                  src="https://placeholdit.com/{{ sub_block.settings.image_width }}x300/ffffff/999999"
                  alt="{{ sub_block.settings.label }}"
                  style="max-width:{{ sub_block.settings.image_width }}px;"
                  height=""
                  width=""
                >
              {% endif %}
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>

  <!-- Step 2 -->
  <div class="section">
    <h3>{{ block.settings.step2_heading }}</h3>
    {% if block.settings.dimensions_image != blank %}
      <img
        src="{{ block.settings.dimensions_image | image_url: width: block.settings.dimensions_image_width }}"
        alt="Sofa dimensions"
        style="width:100%;max-width:{{ block.settings.dimensions_image_width }}px;margin-bottom:1rem;"
        height=""
        width=""
      >
    {% else %}
      <img
        src="https://placeholdit.com/{{ block.settings.dimensions_image_width }}x100/ffffff/999999"
        alt="Sofa dimensions"
        style="width:100%;max-width:{{ block.settings.dimensions_image_width }}px;margin-bottom:1rem;"
        height=""
        width=""
      >
    {% endif %}

    <div class="row options-2">
      <div class="col-12 col-md-4 length-field" data-field="a">
        <div class="title">Length A</div>
        <div class="input-field">
          <input id="length-a" type="number" value="200" placeholder="Enter cm">
          <span class="units">cm</span>
        </div>
      </div>
      <div class="col-12 col-md-4 length-field" data-field="b">
        <div class="title">Length B</div>
        <div class="input-field">
          <input id="length-b" type="number" value="100" placeholder="Enter cm">
          <span class="units">cm</span>
        </div>
      </div>
      <div class="col-12 col-md-4 length-field" data-field="c">
        <div class="title">Length C</div>
        <div class="input-field">
          <input id="length-c" type="number" value="100" placeholder="Enter cm">
          <span class="units">cm</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Step 3 -->
  <div class="section">
    <h3>{{ block.settings.step3_heading }}</h3>
    <div class="row options-3">
      {% assign first_filling = true %}
      {% for sub_block in block.blocks %}
        {% if sub_block.type == 'sofa_filling' %}
          <div class="col{% if first_filling %} active{% endif %}" data-value="{{ sub_block.settings.value }}">
            {% assign first_filling = false %}
            <div class="border rounded mx-auto" style="width: 160px; min-height: 100%;">
              {% if sub_block.settings.image != blank %}
                <img
                  src="{{ sub_block.settings.image | image_url: width: sub_block.settings.image_width }}"
                  alt="{{ sub_block.settings.label }}"
                  style="max-width:{{ sub_block.settings.image_width }}px; padding-top:4px;"
                  height=""
                  width=""
                >
              {% else %}
                <img
                  src="https://placeholdit.com/{{ sub_block.settings.image_width }}/ffffff/999999"
                  alt="{{ sub_block.settings.label }}"
                  style="max-width:{{ sub_block.settings.image_width }}px; margin-top:4px;"
                  height=""
                  width=""
                >
              {% endif %}
              <div class="title">{{ sub_block.settings.label }}</div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>

  <!-- Step 4 -->
  <div class="section">
    <h3>{{ block.settings.step4_heading }}</h3>
    <div class="row options-4">
      {% assign first_filling_option = true %}
      {% for sub_block in block.blocks %}
        {% if sub_block.type == 'filling_option' %}
          <div class="col{% if first_filling_option %} active{% endif %}" data-value="{{ sub_block.settings.value }}">
            {% assign first_filling_option = false %}
            <div class="filling-card">
              <div class="option-title">{{ sub_block.settings.label }}</div>
              <div class="option-price" data-option="{{ sub_block.settings.value }}">Dhs —</div>
              <div class="dropdown-arrow"></div>
              <div class="filling-description">{{ sub_block.settings.description }}</div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>

  <span id="price">Price: Dhs. —</span>
  <span id="monthly">AED —/month (for 4 months)</span>

  <button id="book-btn">{{ block.settings.button_label }}</button>

  {{ 'get-estimate.css' | asset_url | stylesheet_tag }}
  <script src="{{ 'get-estimate.js' | asset_url }}" defer></script>
</section>
